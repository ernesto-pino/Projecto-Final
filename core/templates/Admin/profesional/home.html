<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Panel Profesional ‚Äì MiHora Lampa</title>
    <style>
      :root {
        --cosam-primary: #1769aa;
        --cosam-accent: #2aa86b;
        --ink-900: #0f172a;
        --ink-700: #334155;
        --ink-500: #64748b;
        --ink-300: #cbd5e1;
        --bg-50: #f8fafc;
        --white: #fff;
      }
      * { box-sizing: border-box; }
      html, body { height: 100%; }
      body {
        margin: 0; background: var(--bg-50); color: var(--ink-900);
        font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
      }
      a { color: inherit; text-decoration: none; }
      .container { max-width: 1140px; margin: 0 auto; padding: 24px; }

      /* HERO */
      .hero {
        background: linear-gradient(135deg, var(--cosam-primary), var(--cosam-accent));
        color: #fff; border-radius: 20px; padding: 28px 24px; display: grid; gap: 8px;
      }
      .hero .kicker { opacity: 0.9; font-weight: 600; letter-spacing: 0.3px; font-size: 0.95rem; }
      .hero h1 { margin: 0; font-size: clamp(1.6rem, 2.5vw, 2.2rem); line-height: 1.15; font-weight: 800; }
      .hero .sub { margin: 0; opacity: 0.95; font-size: 1.05rem; }

      /* HERO con bot√≥n a la derecha */
      .hero-top { display: flex; align-items: flex-start; justify-content: space-between; gap: 16px; }
      .btn-ghost {
        background: transparent; color: #fff; border: 2px solid rgba(255,255,255,0.55);
        border-radius: 12px; padding: 0.9rem 1.1rem; font-weight: 700;
        display: inline-flex; align-items: center; justify-content: center;
        transition: background .15s ease, filter .15s ease, transform .05s ease;
      }
      .btn-ghost:hover { background: rgba(255,255,255,0.12); filter: none; }
      .btn-ghost:active { transform: translateY(1px); }
      @media (max-width: 640px) { .hero-top { flex-direction: column; align-items: flex-start; } }

      /* GRID */
      .grid { display: grid; gap: 20px; margin-top: 22px; grid-template-columns: repeat(12, 1fr); }
      .col-8 { grid-column: span 8; }
      .col-4 { grid-column: span 4; }
      @media (max-width: 992px) { .col-8, .col-4 { grid-column: 1 / -1; } }

      /* CARD */
      .card {
        background: #fff; border-radius: 16px;
        box-shadow: 0 12px 30px rgba(2,8,23,.06), 0 2px 8px rgba(2,8,23,.03);
        border: 1px solid rgba(2,8,23,.06);
      }
      .card-h { padding: 18px 18px 0 18px; border-bottom: 1px solid rgba(2,8,23,.06); }
      .card-h h2 { margin: 0; font-size: 1.1rem; font-weight: 700; color: var(--ink-700); }
      .card-b { padding: 18px; }

      /* LISTA Pr√≥ximas atenciones */
      .list { display: flex; flex-direction: column; gap: 12px; margin: 0; padding: 0; list-style: none; }
      .list-item {
        display: flex; align-items: center; gap: 14px; padding: 12px 14px;
        border: 1px solid var(--ink-300); border-radius: 12px; background: #fff;
      }
      .dot { width: 10px; height: 10px; border-radius: 50%; background: var(--cosam-accent); flex: 0 0 10px; }
      .li-title { font-weight: 700; color: var(--ink-700); }
      .li-sub { color: var(--ink-500); font-size: 0.95rem; }
      .badge {
        margin-left: auto; font-size: 0.8rem; padding: 0.35rem 0.6rem; border-radius: 999px;
        background: rgba(23, 105, 170, 0.12); color: var(--cosam-primary); font-weight: 700;
        border: 1px solid rgba(23, 105, 170, 0.18);
      }

      /* ACCIONES + BOTONES */
      .actions { display: grid; gap: 12px; }
      .btn {
        display: inline-flex; align-items: center; justify-content: center; gap: 10px;
        padding: 0.9rem 1.1rem; border-radius: 12px; font-weight: 700; border: 2px solid transparent;
        transition: transform .05s ease, box-shadow .15s ease; text-align: center;
      }
      .btn:active { transform: translateY(1px); }
      .btn-primary { background: var(--cosam-primary); color: #fff; box-shadow: 0 10px 18px rgba(23,105,170,.25); }
      .btn-primary:hover { filter: brightness(.98); }
      .btn-outline { background: #fff; color: var(--cosam-primary); border-color: rgba(23,105,170,.35); }
      .btn-outline:hover { background: rgba(23,105,170,.06); }
      .btn-sm { padding: .55rem .8rem; border-radius: 10px; font-size: .92rem; }

      /* STATS */
      .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
      .stat { background: #fff; border: 1px solid rgba(2,8,23,.06); border-radius: 12px; padding: 14px; }
      .stat .k { color: var(--ink-500); font-size: .9rem; margin: 0 0 4px 0; }
      .stat .v { margin: 0; font-size: 1.4rem; font-weight: 800; color: var(--ink-700); }
      @media (max-width: 480px) { .stats { grid-template-columns: 1fr 1fr; } }

      .sr-only {
        position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px;
        overflow: hidden; clip: rect(0,0,0,0); border: 0;
      }
    </style>
  </head>

  <!-- confirmaci√≥n de cierre de sesi√≥n -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const logoutForm = document.querySelector("form[action=\"{% url 'logout' %}\"]");
      if (logoutForm) {
        logoutForm.addEventListener("submit", function (event) {
          const ok = confirm("¬øEst√° seguro que desea cerrar sesi√≥n?");
          if (!ok) event.preventDefault();
        });
      }
    });
  </script>

  <body>
    <div class="container">
      <!-- HERO con saludo -->
      <section class="hero" aria-labelledby="hero-title">
        <div class="hero-top">
          <div>
            <span class="kicker">MiHora Lampa ¬∑ Profesional</span>
            <h1 id="hero-title">Hola, {{ request.user.first_name|default:"Profesional" }} üëã</h1>
            <p class="sub">Hoy es {% now "l d \d\e F, Y" %}. Revise su agenda y gestione a sus pacientes.</p>
          </div>
          <form method="post" action="{% url 'logout' %}">
            {% csrf_token %}
            <button type="submit" class="btn-ghost">Cerrar sesi√≥n</button>
          </form>
        </div>
      </section>

      <!-- CONTENIDO PRINCIPAL -->
      <section class="grid" aria-label="Panel principal">
        <!-- Columna izquierda: Pr√≥ximas atenciones -->
        <div class="col-8">
          <div class="card">
            <div class="card-h"><h2>Pr√≥ximas atenciones</h2></div>
            <div class="card-b">
              <ul class="list" role="list">
                {% for it in proximas_items %}
                  <li class="list-item">
                    <span class="dot" aria-hidden="true"></span>
                    <div>
                      <div class="li-title">{{ it.paciente }}</div>
                      <div class="li-sub">{{ it.sub }}</div>
                    </div>
                    <span class="badge">{{ it.badge }}</span>
                    <a href="{{ it.url }}" class="btn btn-primary btn-sm" style="margin-left:8px">Abrir</a>
                  </li>
                {% empty %}
                  <li class="list-item">
                    <span class="dot" aria-hidden="true"></span>
                    <div>
                      <div class="li-title">Sin pr√≥ximas atenciones</div>
                      <div class="li-sub">No hay citas futuras registradas.</div>
                    </div>
                  </li>
                {% endfor %}
              </ul>
              <p class="sr-only">La secci√≥n muestra las pr√≥ximas 6 atenciones del profesional si existen.</p>
            </div>
          </div>
        </div>

        <!-- Columna derecha: Acciones + Resumen -->
        <div class="col-4">
          <div class="card" style="margin-bottom:20px">
            <div class="card-h"><h2>Acciones r√°pidas</h2></div>
            <div class="card-b">
              <div class="actions" role="group" aria-label="Acciones principales">
                <a href="{% url 'pro_agendas_list' %}?fecha={% now 'Y-m-d' %}" class="btn btn-primary" aria-label="Ver agenda">Ver agenda</a>
                <a href="{% url 'pro_setup_horario' %}" class="btn btn-outline" aria-label="Mi disponibilidad">Mi disponibilidad</a>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-h"><h2>Resumen</h2></div>
            <div class="card-b">
              <div class="stats" aria-label="Indicadores del d√≠a">
                <div class="stat">
                  <p class="k">Atenciones hoy</p>
                  <p class="v">{{ stats_atenciones_hoy }}</p>
                </div>
                <div class="stat">
                  <p class="k">Pendientes</p>
                  <p class="v">{{ stats_pendientes }}</p>
                </div>
                <div class="stat">
                  <p class="k">Ausencias</p>
                  <p class="v">{{ stats_ausencias }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </body>
</html>
